# /workflows:maintenance - Mantenimiento Sistemático Con Recreation

**29/07/2025 12:00 CDMX** | Comando workflow autocontenido

## Propósito Command
**Input:** Proyecto completo o archivos específicos requiriendo maintenance
**Output:** Sistema alineado con TRUTH_SOURCE.md via recreation + batch processing
**Authority:** context/user-vision/TRUTH_SOURCE.md + /actions:recreate integration

## Filosofía Ejecución
**DEBE ser:** Maintenance proactivo con detection automático de drift
**SIEMPRE produce:** Alignment sistemático via recreation cuando necesario
**NUNCA requiere:** Manual file-by-file analysis - automated health scanning

## Protocol Execution

### Phase 1: System Health Scan
**Trigger:** Usuario solicita maintenance O detection automático de drift
**Process:**
- Scan completo proyecto para detectar archivos >100 líneas
- Identificar duplicaciones conceptuales emergentes entre archivos
- Detectar template compliance violations con modules system
- Verificar references integrity cross-files
- Analizar timestamp consistency y metadata obsoleto
**Validation:** Health report generado con priority ranking de files requiring maintenance

### Phase 2: Drift Detection Analysis
**Input:** Health scan results + TRUTH_SOURCE.md current state
**Process:**
- Comparar cada archivo contra context/user-vision/TRUTH_SOURCE.md authority
- Detectar structural misalignment con context/patterns/simplicity.md
- Identificar sesgo acumulativo por incremental edits
- Evaluar authority conflicts vs supreme truth source
- Calcular drift percentage para trigger recreation threshold
**Output:** Priorized list archivos requiring /actions:recreate intervention

### Phase 3: Batch Recreation Coordination
**Trigger:** Files identified con drift >30% from current guidelines
**Process:**
- Coordinate con /actions:recreate para each file requiring clean slate
- Execute batch processing para multiple recreations simultáneas
- Maintain references consistency durante recreation process
- Apply Think x4 para optimal recreation sequence
- Monitor system coherence durante batch operations
**Validation:** All recreated files 100% aligned + references maintained

### Phase 4: Integration Verification
**Input:** Batch recreation completed + system state updated
**Process:**
- Verificar coherencia ecosystem post-maintenance
- Validate commands integration still functional
- Confirm templates compliance maintained
- Test cross-references integrity preserved
- Generate maintenance completion report
**Output:** Sistema completamente coherent + maintenance visibility report

## Detection Rules Específicas

### File Size Threshold Analysis
**Rule:** Files >100 líneas → candidatos para modularization
**Action:** Evaluate si recreation con modular structure beneficioso
**Integration:** /actions:recreate con modular approach planning

### Conceptual Duplication Detection
**Rule:** Similar concepts repeated >2 files → consolidation analysis
**Action:** Determine si recreation con reference-only approach needed
**Validation:** Preserve information density while eliminating redundancy

### Template Compliance Monitoring
**Rule:** Files violating modules system structure → recreation candidates
**Action:** /actions:recreate con template compliance enforcement
**Authority:** context/templates/ + user-vision/TRUTH_SOURCE.md alignment

### References Integrity Validation
**Rule:** Broken references O outdated links → systematic repair
**Action:** Recreation con updated references system
**Maintenance:** Automated reference validation post-recreation

## Batch Processing Capabilities

### Concurrent Recreation Coordination
**Method:** Multiple /actions:recreate executions simultáneamente
**Coordination:** Dependency-aware sequencing para avoid conflicts
**Efficiency:** Parallel processing cuando files independent

### Priority-Based Processing
**High Priority:** Authority conflicts con TRUTH_SOURCE.md
**Medium Priority:** Structural misalignment + template violations
**Low Priority:** Optimization opportunities + file size concerns

### Progress Tracking System
**Template:** "Maintenance progress: [X/Y] files processed. Current: recreating [FILENAME] (priority: [LEVEL])"
**Continuous:** No interruption - auto-continuation hasta completion
**Reporting:** Real-time visibility de maintenance operations

## Integration Points
**Coordinates with:**
- /actions:recreate → Core recreation engine para drift correction
- /workflows:start → Health scan automático en session initialization
- /actions:docs → Documentation maintenance via recreation when needed
- /roles:orchestrator → Multi-agent coordination para batch operations

**Authority chain:** user-vision/TRUTH_SOURCE.md → drift detection → /actions:recreate delegation

## Error Handling
**Si recreation conflicts:** → Dependency-aware sequencing + manual intervention when needed
**OBLIGATORIO verificar:** TRUTH_SOURCE.md supremacy maintained throughout maintenance
**Fallback mode:** Incremental maintenance cuando recreation technically impossible

## Automated Trigger System

### Detection Thresholds
- **File divergence** >30% from current guidelines → auto-trigger recreation
- **Structural misalignment** detected → recreation recommendation
- **Authority conflicts** identified → immediate recreation priority
- **Reference breaks** detected → integrity restoration maintenance

### Proactive Maintenance
**Session start:** Auto-scan health sistema + maintenance recommendations
**Post-changes:** Dependency scanning para files requiring alignment updates
**Periodic:** Background health monitoring cuando background agent available

## State Management
**Persists:** Maintenance history + health metrics + recreation success rates
**Clears:** Obsolete references + deprecated file states
**Handoff to:** Aligned system state + maintenance completion report

## Usage Examples
1. /workflows:maintenance
   → Full system health scan → Batch recreation files requiring alignment → Completion report

2. /workflows:maintenance context/patterns/
   → Targeted maintenance patterns directory → Recreation drift detected → Integration verification

3. /workflows:maintenance --threshold 20
   → Lower threshold recreation trigger → More aggressive alignment maintenance → Enhanced system coherence

## Maintenance Report Generation

### Health Status Overview
**System Alignment:** % files aligned con TRUTH_SOURCE.md
**Recreation Activity:** Files recreated + success rate
**References Integrity:** Broken links detected + repaired
**Template Compliance:** % files following modules system

### Maintenance Actions Taken
**Recreations Performed:** List files recreated + drift percentages
**Batch Processing:** Concurrent operations + efficiency metrics
**Authority Conflicts:** Resolved conflicts + alignment verified
**Integration Verification:** Cross-system coherence validated

### Recommendations Future
**Proactive Maintenance:** Suggested intervals based on system activity
**Architecture Improvements:** Detected patterns requiring systematic enhancement
**Process Optimization:** Efficiency gains available via better tooling

---
## Enlaces → Información Complementaria
**Si necesitas recreation details:** → .claude/commands/actions/recreate.md:15-50
**Si requieres authority validation:** → context/user-vision/TRUTH_SOURCE.md:93-94
**Si integration issues:** → context/patterns/orchestrator_methodology.md:45-60