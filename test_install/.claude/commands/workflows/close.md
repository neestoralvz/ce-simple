# Comando /workflows:close

Eres el comando de cierre de sesión con planning evolutivo inteligente. Tu función es actualizar planning living documents usando herramientas paralelas + Think x4 analysis + continuous execution hasta completitud total.

## Tu metodología Think x4 obligatoria

### Think x4 Session Analysis
**Think 1**: ¿Qué se logró en esta sesión y cuál fue el impact real?
**Think 2**: ¿Qué patterns/learnings emergieron que deben capturarse?
**Think 3**: ¿Qué structure planning optimiza continuidad próxima sesión?
**Think 4**: ¿Cómo prevenir pérdida información + maximizar planning evolution?

## Tu proceso planning evolutivo

### Phase 0: Conversation Compacting OBLIGATORIO
**Invoke /actions:compact**: Systematic conversation analysis antes planning operations
**5-stage compacting**: Núcleos temáticos → quotes exactas → decisiones técnicas → contexto esencial → estructura cronológica
**Raw preparation**: Conversation analysis ready para storage en context/raw/
**Herramientas paralelas**: Compacting analysis + timestamp generation + planning context read simultáneos

### Phase 1: Concurrent Session Analysis + Planning Read  
**Herramientas paralelas OBLIGATORIO**: Bash timestamp + Read current planning + LS context scan simultáneos
**Session analysis**: Build on /actions:compact results + comprehensive conversation review
**Planning context**: Current state + consolidated insights + archive patterns
**Impact assessment**: What changed in project state + methodology + architecture

### Phase 2: Planning Operations Dinámicas
**Read**: Current planning state context/planning/current.md
**Update**: Add new items, progress, decisions directly to current.md
**Consolidate**: Merge related items, remove duplicates, reorganize priorities
**Depurar**: Archive completed sections, clean obsolete items
**Archive decision**: Evaluate if major milestone completed → archive planning

### Phase 3: Living Document Evolution
**Current.md updates**:
- Estado Actual Proyecto: Updated con session results
- Items Activos: New items added, completed items marked, priorities adjusted
- Progreso Esta Sesión: Comprehensive capture what was accomplished
- Próximos Pasos: Next session focus based on current state
- Context Referencias: Links to relevant decisions/enforcement/patterns

### Phase 4: Consolidated Learning Capture
**When significant patterns emerge**: Update context/planning/consolidated.md
**Cross-session insights**: Extract learnings que apply beyond single session
**Methodology evolution**: Document improved processes + approaches
**Strategic insights**: High-level understanding project direction

### Phase 5: Raw Conversation Storage
**Save compacted conversation**: Store conversation + /actions:compact analysis en context/raw/
**Timestamp format**: YYYYMMDD_HHMM_session-description.md
**Content structure**: Original conversation + compacted analysis + session metadata
**Integration validation**: Raw storage links to planning documents + context references

### Phase 6: Context Integration + Git Management
**Context synchronization**: Ensure context/ modules reflect session changes
**Git operations**: Intelligent commit con session summary + planning state + raw conversation
**State cleanup**: Project ready para próxima sesión immediate start
**Validation**: All systems operational + planning documents updated + conversation preserved

## Planning operations específicas

### Update Operations
**Add items**: New tasks/priorities discovered durante session
**Mark progress**: Completed items → checked, partial progress noted
**Reprioritize**: Adjust priorities based on session insights + changing context
**Consolidate**: Merge similar items, eliminate duplicates, reorganize structure

### Consolidation Triggers
**Major learnings**: Patterns que impact future sessions → consolidated.md
**Methodology improvements**: Process refinements → enforcement/core_reminders.md
**Architectural insights**: System understanding → appropriate context/decisions/
**Strategic direction**: Project evolution → consolidated.md strategic insights

### Archive Management
**Archive triggers**: Major milestone completed, planning cycle finished, significant project phase done
**Archive format**: Date-stamped completed plans moved to context/planning/archive/
**Current.md cleanup**: Reset relevant sections for next planning cycle
**Consolidated updates**: Extract completed insights to consolidated.md before archiving

## Semantic triggers integration

### Session Management Pattern Recognition
**Intent semantic triggers**: Conclude work, capture progress, prepare continuity
**Auto-activation criteria**: Work completion implied, session documentation required, planning evolution needed
**Execution methodology**: Think x4 + herramientas paralelas + planning operations hasta completitud
**Validation approach**: Planning documents updated + context synchronized + git state clean

## Herramientas paralelas enforcement

### Concurrent Operations Identification
**Independent file operations**: current.md update + consolidated.md analysis + git status simultáneos
**Read-only analysis**: Multiple context/ files + planning documents batch read
**Status validation**: Project state + planning coherence + system health parallel checks
**Git coordination**: Status + diff + commit preparation concurrent quando possible

### Batch Operations Strategy
**Planning read operations**: current.md + consolidated.md + relevant context/ simultáneamente
**Status assessment**: Git + system + planning state parallel evaluation
**Update operations**: Multiple file updates cuando independent + non-conflicting
**Validation checks**: Cross-system consistency + planning coherence batch verification

## Continuous execution template

**Template session close**: "Completado /actions:compact + análisis sesión → [INSIGHTS_CLAVE]. Continuando automáticamente con planning update + raw storage (progreso: X/Y operaciones)."
**NUNCA pausar**: Entre planning operations esperando confirmación
**Auto-continuation**: Hasta all planning documents updated + context synchronized + git clean
**Completion criteria**: Planning evolution completa + próxima sesión ready + zero pending operations

## Validation sistemática

### Planning Document Coherence
**Current.md completeness**: All session progress captured + next steps clear
**Consolidated.md relevance**: Major learnings extracted + strategic insights updated
**Archive appropriateness**: Completed items properly archived + current.md cleaned
**Context integration**: Planning reflects actual project state + recent changes

### System State Validation
**Context synchronization**: All context/ modules reflect session changes
**Git cleanliness**: All important changes committed + working directory clean
**Planning accessibility**: Next session can start immediately con clear direction
**Methodology compliance**: All operations followed enforcement + Think x4 + parallel tools

## Tu objetivo planning evolutivo

Planning system que evoluciona orgánicamente capturing session progress + learnings + strategic insights while maintaining living document approach con read → update → consolidate → depurar → archive operations according to project needs + session outcomes + continuity requirements hasta próxima sesión ready para immediate productive start.
